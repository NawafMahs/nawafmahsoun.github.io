import{r as d,j as le}from"./jsx-runtime-e9svsKL-.js";import{u as ut,i as Qe,g as dt,a as it,T as pt,m as ht,L as mt,t as ft}from"./heading-CC3zBnSN.js";import{S as gt}from"./meta-1DdlTqBX.js";import{u as bt}from"./image-CyAsWJ2Q.js";import{u as yt}from"./useWindowSize-BaU--EEd.js";import{V as te,o as et,Q as tt,O as Ge,p as ce,f as He,q as Se,T as ve,R as Et,s as wt,u as _t,H as Pe,F as Ye,v as Fe,b as Oe,w as Tt,x as St,y as vt,z as Pt,W as Rt,e as nt,k as xt,S as Mt,B as At,E as Lt,A as Dt,D as Ot,r as jt,c as kt,a as Ct,I as Ve,n as It,J as Nt,K as Ft,t as zt,N as Ht,m as Yt,U as Bt}from"./three-DoHZmhMI.js";import{c as rt}from"./clamp-e7DugykH.js";import{t as Ut}from"./throttle-BgiUmwhn.js";import{u as Te}from"./use-spring-C3qV9qVq.js";import"./components-DYXJCFuo.js";import"./config-B1ThRYLq.js";import"./index-CmfjIxA9.js";var Gt=Object.defineProperty,Vt=(c,n,i)=>n in c?Gt(c,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[n]=i,Zt=(c,n,i)=>(Vt(c,n+"",i),i);class Xt{constructor(){Zt(this,"_listeners")}addEventListener(n,i){this._listeners===void 0&&(this._listeners={});const e=this._listeners;e[n]===void 0&&(e[n]=[]),e[n].indexOf(i)===-1&&e[n].push(i)}hasEventListener(n,i){if(this._listeners===void 0)return!1;const e=this._listeners;return e[n]!==void 0&&e[n].indexOf(i)!==-1}removeEventListener(n,i){if(this._listeners===void 0)return;const C=this._listeners[n];if(C!==void 0){const f=C.indexOf(i);f!==-1&&C.splice(f,1)}}dispatchEvent(n){if(this._listeners===void 0)return;const e=this._listeners[n.type];if(e!==void 0){n.target=this;const C=e.slice(0);for(let f=0,l=C.length;f<l;f++)C[f].call(this,n);n.target=null}}}var Wt=Object.defineProperty,qt=(c,n,i)=>n in c?Wt(c,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):c[n]=i,s=(c,n,i)=>(qt(c,typeof n!="symbol"?n+"":n,i),i);const ze=new Et,ot=new wt,Kt=Math.cos(70*(Math.PI/180)),at=(c,n)=>(c%n+n)%n;class $t extends Xt{constructor(n,i){super(),s(this,"object"),s(this,"domElement"),s(this,"enabled",!0),s(this,"target",new te),s(this,"minDistance",0),s(this,"maxDistance",1/0),s(this,"minZoom",0),s(this,"maxZoom",1/0),s(this,"minPolarAngle",0),s(this,"maxPolarAngle",Math.PI),s(this,"minAzimuthAngle",-1/0),s(this,"maxAzimuthAngle",1/0),s(this,"enableDamping",!1),s(this,"dampingFactor",.05),s(this,"enableZoom",!0),s(this,"zoomSpeed",1),s(this,"enableRotate",!0),s(this,"rotateSpeed",1),s(this,"enablePan",!0),s(this,"panSpeed",1),s(this,"screenSpacePanning",!0),s(this,"keyPanSpeed",7),s(this,"zoomToCursor",!1),s(this,"autoRotate",!1),s(this,"autoRotateSpeed",2),s(this,"reverseOrbit",!1),s(this,"reverseHorizontalOrbit",!1),s(this,"reverseVerticalOrbit",!1),s(this,"keys",{LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"}),s(this,"mouseButtons",{LEFT:Se.ROTATE,MIDDLE:Se.DOLLY,RIGHT:Se.PAN}),s(this,"touches",{ONE:ve.ROTATE,TWO:ve.DOLLY_PAN}),s(this,"target0"),s(this,"position0"),s(this,"zoom0"),s(this,"_domElementKeyEvents",null),s(this,"getPolarAngle"),s(this,"getAzimuthalAngle"),s(this,"setPolarAngle"),s(this,"setAzimuthalAngle"),s(this,"getDistance"),s(this,"getZoomScale"),s(this,"listenToKeyEvents"),s(this,"stopListenToKeyEvents"),s(this,"saveState"),s(this,"reset"),s(this,"update"),s(this,"connect"),s(this,"dispose"),s(this,"dollyIn"),s(this,"dollyOut"),s(this,"getScale"),s(this,"setScale"),this.object=n,this.domElement=i,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=()=>_.phi,this.getAzimuthalAngle=()=>_.theta,this.setPolarAngle=t=>{let r=at(t,2*Math.PI),u=_.phi;u<0&&(u+=2*Math.PI),r<0&&(r+=2*Math.PI);let R=Math.abs(r-u);2*Math.PI-R<R&&(r<u?r+=2*Math.PI:u+=2*Math.PI),j.phi=r-u,e.update()},this.setAzimuthalAngle=t=>{let r=at(t,2*Math.PI),u=_.theta;u<0&&(u+=2*Math.PI),r<0&&(r+=2*Math.PI);let R=Math.abs(r-u);2*Math.PI-R<R&&(r<u?r+=2*Math.PI:u+=2*Math.PI),j.theta=r-u,e.update()},this.getDistance=()=>e.object.position.distanceTo(e.target),this.listenToKeyEvents=t=>{t.addEventListener("keydown",J),this._domElementKeyEvents=t},this.stopListenToKeyEvents=()=>{this._domElementKeyEvents.removeEventListener("keydown",J),this._domElementKeyEvents=null},this.saveState=()=>{e.target0.copy(e.target),e.position0.copy(e.object.position),e.zoom0=e.object.zoom},this.reset=()=>{e.target.copy(e.target0),e.object.position.copy(e.position0),e.object.zoom=e.zoom0,e.object.updateProjectionMatrix(),e.dispatchEvent(C),e.update(),w=m.NONE},this.update=(()=>{const t=new te,r=new te(0,1,0),u=new tt().setFromUnitVectors(n.up,r),R=u.clone().invert(),V=new te,pe=new tt,Ee=2*Math.PI;return function(){const Je=e.object.position;u.setFromUnitVectors(n.up,r),R.copy(u).invert(),t.copy(Je).sub(e.target),t.applyQuaternion(u),_.setFromVector3(t),e.autoRotate&&w===m.NONE&&p(L()),e.enableDamping?(_.theta+=j.theta*e.dampingFactor,_.phi+=j.phi*e.dampingFactor):(_.theta+=j.theta,_.phi+=j.phi);let he=e.minAzimuthAngle,me=e.maxAzimuthAngle;isFinite(he)&&isFinite(me)&&(he<-Math.PI?he+=Ee:he>Math.PI&&(he-=Ee),me<-Math.PI?me+=Ee:me>Math.PI&&(me-=Ee),he<=me?_.theta=Math.max(he,Math.min(me,_.theta)):_.theta=_.theta>(he+me)/2?Math.max(he,_.theta):Math.min(me,_.theta)),_.phi=Math.max(e.minPolarAngle,Math.min(e.maxPolarAngle,_.phi)),_.makeSafe(),e.enableDamping===!0?e.target.addScaledVector(ae,e.dampingFactor):e.target.add(ae),e.zoomToCursor&&g||e.object.isOrthographicCamera?_.radius=k(_.radius):_.radius=k(_.radius*H),t.setFromSpherical(_),t.applyQuaternion(R),Je.copy(e.target).add(t),e.object.matrixAutoUpdate||e.object.updateMatrix(),e.object.lookAt(e.target),e.enableDamping===!0?(j.theta*=1-e.dampingFactor,j.phi*=1-e.dampingFactor,ae.multiplyScalar(1-e.dampingFactor)):(j.set(0,0,0),ae.set(0,0,0));let Ae=!1;if(e.zoomToCursor&&g){let Le=null;if(e.object instanceof He&&e.object.isPerspectiveCamera){const De=t.length();Le=k(De*H);const Ne=De-Le;e.object.position.addScaledVector(re,Ne),e.object.updateMatrixWorld()}else if(e.object.isOrthographicCamera){const De=new te(o.x,o.y,0);De.unproject(e.object),e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/H)),e.object.updateProjectionMatrix(),Ae=!0;const Ne=new te(o.x,o.y,0);Ne.unproject(e.object),e.object.position.sub(Ne).add(De),e.object.updateMatrixWorld(),Le=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),e.zoomToCursor=!1;Le!==null&&(e.screenSpacePanning?e.target.set(0,0,-1).transformDirection(e.object.matrix).multiplyScalar(Le).add(e.object.position):(ze.origin.copy(e.object.position),ze.direction.set(0,0,-1).transformDirection(e.object.matrix),Math.abs(e.object.up.dot(ze.direction))<Kt?n.lookAt(e.target):(ot.setFromNormalAndCoplanarPoint(e.object.up,e.target),ze.intersectPlane(ot,e.target))))}else e.object instanceof Ge&&e.object.isOrthographicCamera&&(Ae=H!==1,Ae&&(e.object.zoom=Math.max(e.minZoom,Math.min(e.maxZoom,e.object.zoom/H)),e.object.updateProjectionMatrix()));return H=1,g=!1,Ae||V.distanceToSquared(e.object.position)>Z||8*(1-pe.dot(e.object.quaternion))>Z?(e.dispatchEvent(C),V.copy(e.object.position),pe.copy(e.object.quaternion),Ae=!1,!0):!1}})(),this.connect=t=>{e.domElement=t,e.domElement.style.touchAction="none",e.domElement.addEventListener("contextmenu",Me),e.domElement.addEventListener("pointerdown",X),e.domElement.addEventListener("pointercancel",h),e.domElement.addEventListener("wheel",ye)},this.dispose=()=>{var t,r,u,R,V,pe;e.domElement&&(e.domElement.style.touchAction="auto"),(t=e.domElement)==null||t.removeEventListener("contextmenu",Me),(r=e.domElement)==null||r.removeEventListener("pointerdown",X),(u=e.domElement)==null||u.removeEventListener("pointercancel",h),(R=e.domElement)==null||R.removeEventListener("wheel",ye),(V=e.domElement)==null||V.ownerDocument.removeEventListener("pointermove",v),(pe=e.domElement)==null||pe.ownerDocument.removeEventListener("pointerup",h),e._domElementKeyEvents!==null&&e._domElementKeyEvents.removeEventListener("keydown",J)};const e=this,C={type:"change"},f={type:"start"},l={type:"end"},m={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let w=m.NONE;const Z=1e-6,_=new et,j=new et;let H=1;const ae=new te,M=new ce,O=new ce,W=new ce,Y=new ce,U=new ce,I=new ce,b=new ce,ne=new ce,se=new ce,re=new te,o=new ce;let g=!1;const a=[],y={};function L(){return 2*Math.PI/60/60*e.autoRotateSpeed}function S(){return Math.pow(.95,e.zoomSpeed)}function p(t){e.reverseOrbit||e.reverseHorizontalOrbit?j.theta+=t:j.theta-=t}function E(t){e.reverseOrbit||e.reverseVerticalOrbit?j.phi+=t:j.phi-=t}const T=(()=>{const t=new te;return function(u,R){t.setFromMatrixColumn(R,0),t.multiplyScalar(-u),ae.add(t)}})(),ie=(()=>{const t=new te;return function(u,R){e.screenSpacePanning===!0?t.setFromMatrixColumn(R,1):(t.setFromMatrixColumn(R,0),t.crossVectors(e.object.up,t)),t.multiplyScalar(u),ae.add(t)}})(),oe=(()=>{const t=new te;return function(u,R){const V=e.domElement;if(V&&e.object instanceof He&&e.object.isPerspectiveCamera){const pe=e.object.position;t.copy(pe).sub(e.target);let Ee=t.length();Ee*=Math.tan(e.object.fov/2*Math.PI/180),T(2*u*Ee/V.clientHeight,e.object.matrix),ie(2*R*Ee/V.clientHeight,e.object.matrix)}else V&&e.object instanceof Ge&&e.object.isOrthographicCamera?(T(u*(e.object.right-e.object.left)/e.object.zoom/V.clientWidth,e.object.matrix),ie(R*(e.object.top-e.object.bottom)/e.object.zoom/V.clientHeight,e.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),e.enablePan=!1)}})();function q(t){e.object instanceof He&&e.object.isPerspectiveCamera||e.object instanceof Ge&&e.object.isOrthographicCamera?H=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),e.enableZoom=!1)}function G(t){q(H/t)}function ue(t){q(H*t)}function N(t){if(!e.zoomToCursor||!e.domElement)return;g=!0;const r=e.domElement.getBoundingClientRect(),u=t.clientX-r.left,R=t.clientY-r.top,V=r.width,pe=r.height;o.x=u/V*2-1,o.y=-(R/pe)*2+1,re.set(o.x,o.y,1).unproject(e.object).sub(e.object.position).normalize()}function k(t){return Math.max(e.minDistance,Math.min(e.maxDistance,t))}function Q(t){M.set(t.clientX,t.clientY)}function we(t){N(t),b.set(t.clientX,t.clientY)}function ge(t){Y.set(t.clientX,t.clientY)}function _e(t){O.set(t.clientX,t.clientY),W.subVectors(O,M).multiplyScalar(e.rotateSpeed);const r=e.domElement;r&&(p(2*Math.PI*W.x/r.clientHeight),E(2*Math.PI*W.y/r.clientHeight)),M.copy(O),e.update()}function be(t){ne.set(t.clientX,t.clientY),se.subVectors(ne,b),se.y>0?G(S()):se.y<0&&ue(S()),b.copy(ne),e.update()}function Re(t){U.set(t.clientX,t.clientY),I.subVectors(U,Y).multiplyScalar(e.panSpeed),oe(I.x,I.y),Y.copy(U),e.update()}function je(t){N(t),t.deltaY<0?ue(S()):t.deltaY>0&&G(S()),e.update()}function Be(t){let r=!1;switch(t.code){case e.keys.UP:oe(0,e.keyPanSpeed),r=!0;break;case e.keys.BOTTOM:oe(0,-e.keyPanSpeed),r=!0;break;case e.keys.LEFT:oe(e.keyPanSpeed,0),r=!0;break;case e.keys.RIGHT:oe(-e.keyPanSpeed,0),r=!0;break}r&&(t.preventDefault(),e.update())}function ke(){if(a.length==1)M.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),r=.5*(a[0].pageY+a[1].pageY);M.set(t,r)}}function P(){if(a.length==1)Y.set(a[0].pageX,a[0].pageY);else{const t=.5*(a[0].pageX+a[1].pageX),r=.5*(a[0].pageY+a[1].pageY);Y.set(t,r)}}function x(){const t=a[0].pageX-a[1].pageX,r=a[0].pageY-a[1].pageY,u=Math.sqrt(t*t+r*r);b.set(0,u)}function D(){e.enableZoom&&x(),e.enablePan&&P()}function K(){e.enableZoom&&x(),e.enableRotate&&ke()}function $(t){if(a.length==1)O.set(t.pageX,t.pageY);else{const u=Ue(t),R=.5*(t.pageX+u.x),V=.5*(t.pageY+u.y);O.set(R,V)}W.subVectors(O,M).multiplyScalar(e.rotateSpeed);const r=e.domElement;r&&(p(2*Math.PI*W.x/r.clientHeight),E(2*Math.PI*W.y/r.clientHeight)),M.copy(O)}function z(t){if(a.length==1)U.set(t.pageX,t.pageY);else{const r=Ue(t),u=.5*(t.pageX+r.x),R=.5*(t.pageY+r.y);U.set(u,R)}I.subVectors(U,Y).multiplyScalar(e.panSpeed),oe(I.x,I.y),Y.copy(U)}function A(t){const r=Ue(t),u=t.pageX-r.x,R=t.pageY-r.y,V=Math.sqrt(u*u+R*R);ne.set(0,V),se.set(0,Math.pow(ne.y/b.y,e.zoomSpeed)),G(se.y),b.copy(ne)}function de(t){e.enableZoom&&A(t),e.enablePan&&z(t)}function B(t){e.enableZoom&&A(t),e.enableRotate&&$(t)}function X(t){var r,u;e.enabled!==!1&&(a.length===0&&((r=e.domElement)==null||r.ownerDocument.addEventListener("pointermove",v),(u=e.domElement)==null||u.ownerDocument.addEventListener("pointerup",h)),Ie(t),t.pointerType==="touch"?xe(t):F(t))}function v(t){e.enabled!==!1&&(t.pointerType==="touch"?Ce(t):ee(t))}function h(t){var r,u,R;lt(t),a.length===0&&((r=e.domElement)==null||r.releasePointerCapture(t.pointerId),(u=e.domElement)==null||u.ownerDocument.removeEventListener("pointermove",v),(R=e.domElement)==null||R.ownerDocument.removeEventListener("pointerup",h)),e.dispatchEvent(l),w=m.NONE}function F(t){let r;switch(t.button){case 0:r=e.mouseButtons.LEFT;break;case 1:r=e.mouseButtons.MIDDLE;break;case 2:r=e.mouseButtons.RIGHT;break;default:r=-1}switch(r){case Se.DOLLY:if(e.enableZoom===!1)return;we(t),w=m.DOLLY;break;case Se.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enablePan===!1)return;ge(t),w=m.PAN}else{if(e.enableRotate===!1)return;Q(t),w=m.ROTATE}break;case Se.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(e.enableRotate===!1)return;Q(t),w=m.ROTATE}else{if(e.enablePan===!1)return;ge(t),w=m.PAN}break;default:w=m.NONE}w!==m.NONE&&e.dispatchEvent(f)}function ee(t){if(e.enabled!==!1)switch(w){case m.ROTATE:if(e.enableRotate===!1)return;_e(t);break;case m.DOLLY:if(e.enableZoom===!1)return;be(t);break;case m.PAN:if(e.enablePan===!1)return;Re(t);break}}function ye(t){e.enabled===!1||e.enableZoom===!1||w!==m.NONE&&w!==m.ROTATE||(t.preventDefault(),e.dispatchEvent(f),je(t),e.dispatchEvent(l))}function J(t){e.enabled===!1||e.enablePan===!1||Be(t)}function xe(t){switch($e(t),a.length){case 1:switch(e.touches.ONE){case ve.ROTATE:if(e.enableRotate===!1)return;ke(),w=m.TOUCH_ROTATE;break;case ve.PAN:if(e.enablePan===!1)return;P(),w=m.TOUCH_PAN;break;default:w=m.NONE}break;case 2:switch(e.touches.TWO){case ve.DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;D(),w=m.TOUCH_DOLLY_PAN;break;case ve.DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;K(),w=m.TOUCH_DOLLY_ROTATE;break;default:w=m.NONE}break;default:w=m.NONE}w!==m.NONE&&e.dispatchEvent(f)}function Ce(t){switch($e(t),w){case m.TOUCH_ROTATE:if(e.enableRotate===!1)return;$(t),e.update();break;case m.TOUCH_PAN:if(e.enablePan===!1)return;z(t),e.update();break;case m.TOUCH_DOLLY_PAN:if(e.enableZoom===!1&&e.enablePan===!1)return;de(t),e.update();break;case m.TOUCH_DOLLY_ROTATE:if(e.enableZoom===!1&&e.enableRotate===!1)return;B(t),e.update();break;default:w=m.NONE}}function Me(t){e.enabled!==!1&&t.preventDefault()}function Ie(t){a.push(t)}function lt(t){delete y[t.pointerId];for(let r=0;r<a.length;r++)if(a[r].pointerId==t.pointerId){a.splice(r,1);return}}function $e(t){let r=y[t.pointerId];r===void 0&&(r=new ce,y[t.pointerId]=r),r.set(t.pageX,t.pageY)}function Ue(t){const r=t.pointerId===a[0].pointerId?a[1]:a[0];return y[r.pointerId]}this.dollyIn=(t=S())=>{ue(t),e.update()},this.dollyOut=(t=S())=>{G(t),e.update()},this.getScale=()=>H,this.setScale=t=>{q(t),e.update()},this.getZoomScale=()=>S(),i!==void 0&&this.connect(i),this.update()}}class Jt extends _t{constructor(n){super(n),this.type=Pe}parse(n){const l=function(o,g){switch(o){case 1:throw new Error("THREE.RGBELoader: Read Error: "+(g||""));case 2:throw new Error("THREE.RGBELoader: Write Error: "+(g||""));case 3:throw new Error("THREE.RGBELoader: Bad File Format: "+(g||""));default:case 4:throw new Error("THREE.RGBELoader: Memory Error: "+(g||""))}},_=`
`,j=function(o,g,a){g=g||1024;let L=o.pos,S=-1,p=0,E="",T=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));for(;0>(S=T.indexOf(_))&&p<g&&L<o.byteLength;)E+=T,p+=T.length,L+=128,T+=String.fromCharCode.apply(null,new Uint16Array(o.subarray(L,L+128)));return-1<S?(o.pos+=p+S+1,E+T.slice(0,S)):!1},H=function(o){const g=/^#\?(\S+)/,a=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,y=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,L=/^\s*FORMAT=(\S+)\s*$/,S=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,p={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};let E,T;for((o.pos>=o.byteLength||!(E=j(o)))&&l(1,"no header found"),(T=E.match(g))||l(3,"bad initial token"),p.valid|=1,p.programtype=T[1],p.string+=E+`
`;E=j(o),E!==!1;){if(p.string+=E+`
`,E.charAt(0)==="#"){p.comments+=E+`
`;continue}if((T=E.match(a))&&(p.gamma=parseFloat(T[1])),(T=E.match(y))&&(p.exposure=parseFloat(T[1])),(T=E.match(L))&&(p.valid|=2,p.format=T[1]),(T=E.match(S))&&(p.valid|=4,p.height=parseInt(T[1],10),p.width=parseInt(T[2],10)),p.valid&2&&p.valid&4)break}return p.valid&2||l(3,"missing format specifier"),p.valid&4||l(3,"missing image size specifier"),p},ae=function(o,g,a){const y=g;if(y<8||y>32767||o[0]!==2||o[1]!==2||o[2]&128)return new Uint8Array(o);y!==(o[2]<<8|o[3])&&l(3,"wrong scanline width");const L=new Uint8Array(4*g*a);L.length||l(4,"unable to allocate buffer space");let S=0,p=0;const E=4*y,T=new Uint8Array(4),ie=new Uint8Array(E);let oe=a;for(;oe>0&&p<o.byteLength;){p+4>o.byteLength&&l(1),T[0]=o[p++],T[1]=o[p++],T[2]=o[p++],T[3]=o[p++],(T[0]!=2||T[1]!=2||(T[2]<<8|T[3])!=y)&&l(3,"bad rgbe scanline format");let q=0,G;for(;q<E&&p<o.byteLength;){G=o[p++];const N=G>128;if(N&&(G-=128),(G===0||q+G>E)&&l(3,"bad scanline data"),N){const k=o[p++];for(let Q=0;Q<G;Q++)ie[q++]=k}else ie.set(o.subarray(p,p+G),q),q+=G,p+=G}const ue=y;for(let N=0;N<ue;N++){let k=0;L[S]=ie[N+k],k+=y,L[S+1]=ie[N+k],k+=y,L[S+2]=ie[N+k],k+=y,L[S+3]=ie[N+k],S+=4}oe--}return L},M=function(o,g,a,y){const L=o[g+3],S=Math.pow(2,L-128)/255;a[y+0]=o[g+0]*S,a[y+1]=o[g+1]*S,a[y+2]=o[g+2]*S,a[y+3]=1},O=function(o,g,a,y){const L=o[g+3],S=Math.pow(2,L-128)/255;a[y+0]=Fe.toHalfFloat(Math.min(o[g+0]*S,65504)),a[y+1]=Fe.toHalfFloat(Math.min(o[g+1]*S,65504)),a[y+2]=Fe.toHalfFloat(Math.min(o[g+2]*S,65504)),a[y+3]=Fe.toHalfFloat(1)},W=new Uint8Array(n);W.pos=0;const Y=H(W),U=Y.width,I=Y.height,b=ae(W.subarray(W.pos),U,I);let ne,se,re;switch(this.type){case Ye:re=b.length/4;const o=new Float32Array(re*4);for(let a=0;a<re;a++)M(b,a*4,o,a*4);ne=o,se=Ye;break;case Pe:re=b.length/4;const g=new Uint16Array(re*4);for(let a=0;a<re;a++)O(b,a*4,g,a*4);ne=g,se=Pe;break;default:throw new Error("THREE.RGBELoader: Unsupported type: "+this.type)}return{width:U,height:I,data:ne,header:Y.string,gamma:Y.gamma,exposure:Y.exposure,type:se}}setDataType(n){return this.type=n,this}load(n,i,e,C){function f(l,m){switch(l.type){case Ye:case Pe:"colorSpace"in l?l.colorSpace="srgb-linear":l.encoding=3e3,l.minFilter=Oe,l.magFilter=Oe,l.generateMipmaps=!1,l.flipY=!0;break}i&&i(l,m)}return super.load(n,f,e,C)}}class Qt extends Tt{constructor(n){super(n),this.hdrLoader=new Jt,this.type=Pe}load(n,i,e,C){typeof n=="string"?n=[n]:Array.isArray(n)||(console.warn("THREE.HDRCubeTextureLoader signature has changed. Use .setDataType() instead."),this.setDataType(n),n=i,i=e,e=C,C=arguments[4]);const f=new St;switch(f.type=this.type,f.type){case Ye:case Pe:"colorSpace"in f?f.colorSpace="srgb-linear":f.encoding=3e3,f.minFilter=Oe,f.magFilter=Oe,f.generateMipmaps=!1;break}const l=this;let m=0;function w(Z,_,j,H){new vt(l.manager).setPath(l.path).setResponseType("arraybuffer").setWithCredentials(l.withCredentials).load(n[Z],function(ae){m++;const M=l.hdrLoader.parse(ae);if(M){if(M.data!==void 0){const O=new Pt(M.data,M.width,M.height);O.type=f.type,"colorSpace"in O?O.colorSpace=f.SRGBColorSpace:O.encoding=f.encoding,O.format=f.format,O.minFilter=f.minFilter,O.magFilter=f.magFilter,O.generateMipmaps=f.generateMipmaps,f.images[Z]=O}m===6&&(f.needsUpdate=!0,_&&_(f))}},j,H)}for(let Z=0;Z<n.length;Z++)w(Z,i,e,C);return f}setDataType(n){return this.type=n,this.hdrLoader.setDataType(n),this}}const en="/assets/earth-DvZudj9K.glb",tn="/assets/milkyway-nx-Ds_hwpSC.hdr",nn="/assets/milkyway-ny-BqhFvupA.hdr",rn="/assets/milkyway-nz-D6l6T-pv.hdr",on="/assets/milkyway-px-BjIdbMt0.hdr",an="/assets/milkyway-py-BD6pEbZF.hdr",sn="/assets/milkyway-pz-Bx3WFS88.hdr",cn="/assets/milkyway-Vkpv7LbT.jpg",ln="_earth_4tqjk_1",un="_loader_4tqjk_15",dn="_viewport_4tqjk_43",pn="_canvas_4tqjk_65",hn="_labels_4tqjk_103",mn="_label_4tqjk_103",fn="_vignette_4tqjk_163",gn="_sections_4tqjk_187",bn="_section_4tqjk_187",fe={earth:ln,loader:un,viewport:dn,canvas:pn,labels:hn,label:mn,vignette:fn,sections:gn,section:bn},Ke={x:0,y:0,z:2},Ze=(c,n,i)=>c+i*(n-c),st=c=>Object.keys(c).map(n=>parseFloat(Math.round(c[n]*100)/100).toFixed(2)).join(", "),Xe=c=>!c||!c.camera?Ke:{x:c.camera[0],y:c.camera[1],z:c.camera[2]},yn=(c,n)=>{const i=(e=0)=>Math.round((e+Number.EPSILON)*100)/100;return i(c==null?void 0:c.x)===i(n==null?void 0:n.x)&&i(c==null?void 0:c.y)===i(n==null?void 0:n.y)&&i(c==null?void 0:c.z)===i(n==null?void 0:n.z)},We={stiffness:80,damping:40,mass:2,restSpeed:.001,restDelta:.001},qe={stiffness:40,damping:30,mass:2,restSpeed:.001,restDelta:.001},En={stiffness:40,damping:30},ct=d.createContext({}),jn=({position:c=[0,0,0],scale:n=1,hideMeshes:i=[],labels:e=[],className:C,children:f})=>{const[l,m]=d.useState(!1),[w,Z]=d.useState(!1),[_,j]=d.useState(!1),[H,ae]=d.useState(!1),M=d.useRef([]),O=d.useRef(),W=d.useRef(),Y=d.useRef(),U=d.useRef(),I=d.useRef(),b=d.useRef(),ne=d.useRef(),se=d.useRef(),re=d.useRef(),o=d.useRef(),g=d.useRef(),a=d.useRef(),y=bt(Y),L=d.useRef(),S=d.useRef(Xe(M.current[0])),p=d.useRef([]),E=d.useRef(),T=d.useRef(),ie=d.useRef(),oe=d.useRef(),{width:q,height:G}=yt(),ue=ut(),N=Te(0,We),k=Te(0,We),Q=Te(0,We),we=Te(0,qe),ge=Te(0,qe),_e=Te(0,qe),be=Te(0,En),Re=d.useCallback(()=>{if(!y){cancelAnimationFrame(L.current);return}L.current=requestAnimationFrame(Re);const P=ne.current.getDelta();a.current.update(P),E.current.update(),I.current.render(U.current,b.current),p.current.forEach(x=>{const{element:D,position:K,sprite:$}=x,z=new te(...K),A=b.current.position.distanceTo(o.current.position),B=b.current.position.distanceTo($.position)>A;z.project(b.current),z.x=Math.round((.5+z.x/2)*window.innerWidth),z.y=Math.round((.5-z.y/2)*window.innerHeight),D.style.setProperty("--posX",Qe(z.x)),D.style.setProperty("--posY",Qe(z.y)),B?D.dataset.occluded=!0:D.dataset.occluded=!1})},[y]);d.useEffect(()=>{oe.current=!0;const{innerWidth:P,innerHeight:x}=window;I.current=new Rt({canvas:Y.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),I.current.setPixelRatio(1),I.current.outputColorSpace=nt,I.current.toneMapping=xt,b.current=new He(54,P/x,.1,100),b.current.position.x=S.current.x,b.current.position.y=S.current.y,b.current.position.z=S.current.z,b.current.lookAt(0,0,0),N.set(b.current.position.x,!1),k.set(b.current.position.y,!1),Q.set(b.current.position.z,!1),U.current=new Mt,ne.current=new At,re.current=new Lt;const D=new Dt(2236962,.05),K=new Ot(16777215,1.5);K.position.set(3,0,1);const $=[D,K];return $.forEach(z=>U.current.add(z)),E.current=new $t(b.current,Y.current),E.current.enableZoom=!1,E.current.enablePan=!1,E.current.enableDamping=!1,E.current.rotateSpeed=.5,()=>{oe.current=!1,cancelAnimationFrame(L.current),jt($),kt(U.current),Ct(I.current)}},[]),d.useEffect(()=>{const P=()=>{Z(!0),N.stop(),k.stop(),Q.stop()},x=()=>{N.set(b.current.position.x,!1),k.set(b.current.position.y,!1),Q.set(b.current.position.z,!1),Z(!1)};return E.current.addEventListener("start",P),E.current.addEventListener("end",x),()=>{E.current.removeEventListener("start",P),E.current.removeEventListener("end",x)}},[N,k,Q]),d.useEffect(()=>{if(!l)return;const P=Ve("Chunk",o.current),x=Ve("Atmosphere",o.current),D=(h,F)=>{b.current.position[h]=F},K=N.on("change",h=>D("x",h)),$=k.on("change",h=>D("y",h)),z=Q.on("change",h=>D("z",h)),A=(h,F)=>{P.position[h]=F},de=we.on("change",h=>A("x",h)),B=ge.on("change",h=>A("y",h)),X=_e.on("change",h=>A("z",h)),v=be.on("change",h=>{x.material.opacity=h});return()=>{K(),$(),z(),de(),B(),X(),v()}},[N,k,Q,we,ge,_e,l,be]),d.useEffect(()=>{q<=dt.tablet&&(E.current.enabled=!1)},[q]),d.useEffect(()=>{if(l)return;const P=new Qt,x=new It(I.current);x.compileCubemapShader();const D=async()=>{const A=await Yt.loadAsync(en);o.current=A.scene,g.current=A.animations,a.current=new Bt(o.current),a.current.timeScale=.1,o.current.traverse(async de=>{const{material:B,name:X}=de;X==="Atmosphere"&&(B.alphaMap=B.map),B&&await I.current.initTexture(B)}),o.current.position.x=c[0],o.current.position.y=c[1],o.current.position.z=c[2],o.current.scale.x=n,o.current.scale.y=n,o.current.scale.z=n},K=async()=>{const A=await P.loadAsync([tn,nn,rn,on,an,sn]);A.magFilter=Oe,T.current=x.fromCubemap(A),x.dispose(),await I.current.initTexture(T.current.texture)},$=async()=>{const A=await zt.loadAsync(cn);A.mapping=Ht,A.colorSpace=nt,U.current.background=A,await I.current.initTexture(A)},z=async()=>{await Promise.all([$(),K(),D()]),o.current.traverse(({material:A})=>{A&&(A.envMap=T.current.texture,A.needsUpdate=!0)}),oe.current&&m(!0)};d.startTransition(()=>{z(),setTimeout(()=>{ae(!0)},1e3)})},[l,c,n]),d.useEffect(()=>(l&&!ie.current&&(U.current.add(o.current),ie.current=!0),l&&y&&(j(!0),Re()),()=>{cancelAnimationFrame(L.current)}),[Re,y,l]),d.useEffect(()=>{l&&(W.current.innerHTML="",p.current=e.map(P=>{const x=document.createElement("div");x.classList.add(fe.label),x.dataset.hidden=!0,x.style.setProperty("--delay",`${P.delay||0}ms`),x.textContent=P.text,W.current.appendChild(x);const D=new Nt;return D.position.set(...P.position),D.scale.set(60,60,1),{element:x,...P,sprite:D}}))},[e,l]),d.useEffect(()=>{I.current.setSize(q,G),b.current.aspect=q/G,b.current.updateProjectionMatrix()},[q,G]),d.useEffect(()=>{const P=Y.current,x=D=>{const{innerWidth:K,innerHeight:$}=window,z=st(b.current.position);console.info({cameraPosition:z}),se.current=new ce(D.clientX/K*2-1,-(D.clientY/$)*2+1),re.current.setFromCamera(se.current,b.current);const A=re.current.intersectObjects(U.current.children,!0);if(A.length>0){const de=st(A[0].point);console.info({clickPosition:de})}};return()=>{P.removeEventListener("click",x)}},[]);const je=d.useCallback(()=>{if(!O.current)return;const{offsetTop:P}=O.current,{innerHeight:x}=window,D=window.scrollY-P;let K;const $=B=>{const X=M.current[B].meshes;o.current.traverse(v=>{const{name:h}=v,F=Ve("Chunk",o.current),ee=X==null?void 0:X.includes(h),ye=i==null?void 0:i.includes(h);if(ee)if(h==="Atmosphere")v.visible=!0,be.set(1);else if(h==="Chunk"){const J=new te(-.4,.4,.4);v.visible=!0,ue?v.position.set(...J.toArray()):(we.set(J.x),ge.set(J.y),_e.set(J.z))}else h==="EarthFull"&&F.visible?v.visible=!1:v.visible=!0;else if(ye&&!ee)if(h==="Atmosphere")be.set(0);else if(h==="Chunk"){const J=new te(0,0,0);yn(J,F.position)&&(v.visible=!1),we.set(J.x),ge.set(J.y),_e.set(J.z)}else h==="EarthPartial"&&F.visible?v.visible=!0:v.visible=!1})},z=B=>{const X=M.current[B].animations;ue||(g.current.forEach((v,h)=>{X.find(F=>F.includes(h.toString()))||a.current.clipAction(v).reset().stop()}),g.current.length&&M.current[B].animations&&X.forEach(v=>{const h=v.split(":"),F=g.current[Number(h[0])],ee=a.current.clipAction(F);(!h[1]||h[1]!=="loop")&&(ee.clampWhenFinished=!0,ee.loop=Ft),ee.play()}))},A=B=>{p.current.forEach(v=>{v.hidden&&(v.element.dataset.hidden=!0,v.element.setAttribute("aria-hidden",!0))}),M.current[B].labels.forEach(v=>{p.current.filter(F=>F.text===v).forEach(F=>{F.element.dataset.hidden=!1,F.element.setAttribute("aria-hidden",!1)})})};requestAnimationFrame(()=>{const B=M.current.length-1,X=Math.floor(D/x),v=rt(X,0,B),h=M.current[v],F=M.current[v+1],ee=Xe(h)||Ke,ye=Xe(F)||Ke,J=(D-x*v)/x,xe=rt(J,0,1),Ce=Ze(ee.x,ye.x,xe),Me=Ze(ee.y,ye.y,xe),Ie=Ze(ee.z,ye.z,xe);if(K!==ee&&M.current.length&&h&&($(v),z(v),A(v)),K=ee,!w){if(ue){b.current.position.set(Ce,Me,Ie);return}N.set(Ce),k.set(Me),Q.set(Ie)}})},[N,k,Q,we,ge,_e,w,i,be,ue]);d.useEffect(()=>{const P=Ut(je,100);return l&&y&&window.addEventListener("scroll",P),()=>{window.removeEventListener("scroll",P)}},[je,y,l,be]);const Be=d.useCallback(P=>{M.current=[...M.current,P]},[]),ke=d.useCallback(P=>{M.current=M.current.filter(x=>x!==P)},[]);return le.jsx(ct.Provider,{value:{registerSection:Be,unregisterSection:ke},children:le.jsxs("div",{className:it(fe.earth,C),ref:O,children:[le.jsxs("div",{className:fe.viewport,children:[le.jsx("canvas",{className:fe.canvas,"data-visible":l&&_,"data-grabbing":w,ref:Y}),le.jsx("div",{className:fe.labels,"aria-live":"polite",ref:W}),le.jsx("div",{className:fe.vignette})]}),le.jsx("div",{className:fe.sections,children:f}),le.jsx(pt,{unmount:!0,in:!l&&H,timeout:ht(ft.base.durationL),children:P=>le.jsx(gt,{className:fe.loader,"data-visible":P,children:le.jsx(mt,{})})})]})})},kn=d.memo(({children:c,scrim:n,scrimReverse:i,className:e,camera:C=[0,0,0],animations:f=[],meshes:l=[],labels:m=[]})=>{const{registerSection:w,unregisterSection:Z}=d.useContext(ct),_=d.useRef(),j=JSON.stringify(f)+JSON.stringify(C)+JSON.stringify(m)+JSON.stringify(l);return d.useEffect(()=>{const H={camera:C,animations:f,meshes:l,labels:m,sectionRef:_};return w(H),()=>{Z(H)}},[j,w,Z]),le.jsx("div",{className:it(fe.section,e),"data-scrim":n,"data-scrim-reverse":i,ref:_,children:c})});export{jn as Earth,kn as EarthSection};
