import{j as e}from"./jsx-runtime-i88aexF6.js";import{c as r,a as t,m as s,L as n,t as a,b as o,n as i}from"./heading-BdKyha8q.js";import{r as c}from"./vendor-react-vendor-C-CbGDQp.js";import{al as u,aq as m,ar as d,P as l,am as p,as as f,$ as v,at as h,D as j,a0 as w}from"./vendor-three-vendor-BYQyMLel.js";import{r as g,c as b,a as x,m as y}from"./three-DIuK_0bK.js";import{t as z}from"./throttle-C5AzcUjb.js";import{u as k,a as E}from"./vendor-animation-vendor-CcTNfguF.js";import{b as C}from"./image-BJ49fZDF.js";import"./vendor-remix-vendor-Bg8iBN6h.js";import"./three-stdlib-C8EuNLCY.js";const R={stiffness:40,damping:20,mass:1.5},S=({showDelay:S=0,cameraPosition:_={x:0,y:0,z:6},className:L,alt:P,...N})=>{const[T,B]=c.useState(!1),[H,M]=c.useState(!1),[D,W]=c.useState(!1),q=c.useRef(),A=c.useRef(),G=c.useRef(),K=c.useRef(),F=c.useRef(),I=c.useRef(),V=c.useRef(),X=C(q,!1,{threshold:.4}),Y=k(),Z=E(0,R),$=E(0,R);c.useEffect(()=>{const{clientWidth:e,clientHeight:r}=q.current;I.current=new u({canvas:A.current,alpha:!0,antialias:!1,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),I.current.setPixelRatio(2),I.current.setSize(e,r),I.current.outputColorSpace=m,I.current.toneMapping=d,G.current=new l(36,e/r,.1,100),G.current.position.set(_.x,_.y,_.z),F.current=new p;const t=new f;K.current=new v,F.current.add(K.current);const s=new h(I.current);s.compileCubemapShader();const n=new j(16777215,2.6),a=new j(16777215,1),o=new j(16777215,1.3);n.position.set(1,.1,2),a.position.set(-1,.1,8),o.position.set(-2,2,-3),V.current=[o,n,a],V.current.forEach(e=>F.current.add(e)),c.startTransition(()=>{(async()=>{const e=y.loadAsync("/assets/volkihar-knight-BtFNLzdG.glb"),r=t.loadAsync(["/assets/volkihar-cube-nx-B7Zjde9E.jpg","/assets/volkihar-cube-ny-K8Ej-0KC.jpg","/assets/volkihar-cube-nz-CwSlGC5m.jpg","/assets/volkihar-cube-px-B6VuHL6s.jpg","/assets/volkihar-cube-py-nbSfCjcD.jpg","/assets/volkihar-cube-pz-Bzqv8d-T.jpg"]),[n,a]=await Promise.all([e,r]);K.current.add(n.scene),n.scene.rotation.y=w.degToRad(180),n.scene.position.y=-1.6;const{texture:o}=s.fromCubemap(a);F.current.environment=o,s.dispose(),await I.current.initTexture(F.current.environment),K.current.traverse(async e=>{e.material&&await I.current.initTexture(e.material)}),B(!0),J()})(),setTimeout(()=>{W(!0)},1e3)});const i=Z.on("change",e=>{K.current.rotation.x=e,J()}),z=$.on("change",e=>{K.current.rotation.y=e,J()});return()=>{g(V.current),b(F.current),x(I.current),i(),z()}},[]);const J=c.useCallback(()=>{I.current.render(F.current,G.current)},[]);return c.useEffect(()=>{const e=z(e=>{const{innerWidth:r,innerHeight:t}=window,s=(e.clientX-r/2)/r,n=(e.clientY-t/2)/t;Z.set(n/2),$.set(s/2)},100);return X&&M(!0),X&&!Y&&window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}},[X,Y,Z,$]),c.useEffect(()=>{const e=()=>{if(!q.current)return;const{clientWidth:e,clientHeight:r}=q.current;I.current.setSize(e,r),G.current.aspect=e/r,G.current.updateProjectionMatrix(),J()};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[J]),e.jsxs("div",{className:r("_armor_1r5zf_1",L),ref:q,role:"img","aria-label":P,...N,children:[e.jsx(t,{unmount:!0,in:!T&&D,timeout:s(a.base.durationL),children:({visible:r})=>e.jsx(n,{className:"_loader_1r5zf_7","data-visible":r})}),e.jsx("canvas",{className:"_canvas_1r5zf_16",ref:A,"data-loaded":T&&H,style:o({delay:i(S)})})]})};export{S as Armor};
