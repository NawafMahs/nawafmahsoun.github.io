import{j as e}from"./jsx-runtime-i88aexF6.js";import{r}from"./vendor-react-vendor-C-CbGDQp.js";import{al as t,O as n,am as a,C as i,an as o,s as c,ao as s,ap as u,W as l}from"./vendor-three-vendor-BYQyMLel.js";import{b as d,r as m}from"./image-BJ49fZDF.js";import{b as v}from"./heading-BdKyha8q.js";import{c as f,a as p,t as g}from"./three-DIuK_0bK.js";import{u as x,c as h}from"./vendor-animation-vendor-CcTNfguF.js";import"./vendor-remix-vendor-Bg8iBN6h.js";import"./three-stdlib-C8EuNLCY.js";const _="_button_156nm_52";function b(e,r,t,n){if(null!==r)return r;const a=t.length;return n>0?(e+1)%a:(e-1+a)%a}const w=({width:w,height:I,images:F,placeholder:C,...R})=>{const[E,k]=r.useState(!1),[M,S]=r.useState(0),[L,A]=r.useState(!1),[D,N]=r.useState(!0),[P,U]=r.useState(),[q,z]=r.useState(),$=r.useRef(),T=r.useRef(),B=r.useRef(),W=r.useRef(),X=r.useRef(),J=r.useRef(),K=r.useRef(),O=r.useRef(!1),V=r.useRef(),G=r.useRef(),H=r.useRef(),Q=x(),Y=d($,!0),Z=r.useRef(),ee=r.useRef(),re=`Slide ${M+1} of ${F.length}. ${F[M].alt}`;r.useEffect(()=>(E&&(document.body.style.cursor="grabbing"),()=>{document.body.style.cursor=""}),[E]),r.useEffect(()=>{const e=[w/-2,w/2,I/2,I/-2,1,1e3];return K.current=new t({canvas:$.current,antialias:!1,alpha:!0,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!0}),J.current=new n(...e),X.current=new a,K.current.setPixelRatio(2),K.current.setClearColor(1118481,1),K.current.setSize(w,I),K.current.domElement.style.width="100%",K.current.domElement.style.height="auto",X.current.background=new i(1118481),J.current.position.z=1,()=>{O.current=!1,f(X.current),p(K.current)}},[I,w]),r.useEffect(()=>{let e=!0;return Y&&!L&&(async()=>{const r=K.current.capabilities.getMaxAnisotropy(),t=F.map(async e=>{const t=e.srcSet?await m(e):e.src,n=await g.loadAsync(t);return await K.current.initTexture(n),n.colorSpace=o,n.minFilter=c,n.magFilter=c,n.anisotropy=r,n.generateMipmaps=!1,n}),n=await Promise.all(t);e&&(W.current=new s({uniforms:{dispFactor:{type:"f",value:0},direction:{type:"f",value:1},currentImage:{type:"t",value:n[0]},nextImage:{type:"t",value:n[1]},reduceMotion:{type:"b",value:Q}},vertexShader:"varying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n}\n",fragmentShader:"varying vec2 vUv;\nuniform sampler2D currentImage;\nuniform sampler2D nextImage;\nuniform float dispFactor;\nuniform float direction;\nuniform bool reduceMotion;\n\nvoid main() {\n  if (reduceMotion) {\n    // Simple crossfade\n    vec4 _currentImage = texture2D(currentImage, vUv);\n    vec4 _nextImage = texture2D(nextImage, vUv);\n    vec4 finalTexture = mix(_currentImage, _nextImage, dispFactor);\n    gl_FragColor = finalTexture;\n  } else {\n    // Liquid distortion effect\n    vec2 uv = vUv;\n    vec4 _currentImage;\n    vec4 _nextImage;\n    float intensity = 0.6;\n\n    vec4 orig1 = texture2D(currentImage, uv);\n    vec4 orig2 = texture2D(nextImage, uv);\n\n    vec2 distortedPosition = vec2(\n      uv.x + direction * (dispFactor * (orig2.r * intensity)),\n      uv.y + direction * (dispFactor * (orig2 * intensity))\n    );\n\n    vec2 distortedPosition2 = vec2(\n      uv.x - direction * ((1.0 - dispFactor) * (orig1.r * intensity)),\n      uv.y - direction * ((1.0 - dispFactor) * (orig1 * intensity))\n    );\n\n    _currentImage = texture2D(currentImage, distortedPosition);\n    _nextImage = texture2D(nextImage, distortedPosition2);\n\n    vec4 finalTexture = mix(_currentImage, _nextImage, dispFactor);\n    gl_FragColor = finalTexture;\n  }\n}\n",transparent:!1,opacity:1}),B.current=new u(w,I,1),T.current=new l(B.current,W.current),T.current.position.set(0,0,0),X.current.add(T.current),A(!0),U(n),requestAnimationFrame(()=>{K.current.render(X.current,J.current)}))})(),()=>{e=!1}},[I,F,Y,L,Q,w]);const te=r.useCallback(({index:e,direction:r=1})=>{if(!P)return;S(e);const{uniforms:t}=W.current;t.nextImage.value=P[e],t.direction.value=r,1!==t.dispFactor.value&&(O.current=!0,h(t.dispFactor.value,1,{type:"spring",stiffness:100,damping:20,restSpeed:.001,restDelta:.001,onUpdate:e=>{t.dispFactor.value=e},onComplete:()=>{t.currentImage.value=P[e],t.dispFactor.value=0,O.current=!1}}))},[P]),ne=r.useCallback(({direction:e,index:r=null,...t})=>{if(!L)return;if(O.current)return cancelAnimationFrame(H.current),void(H.current=requestAnimationFrame(()=>ne({direction:e,index:r,...t})));const n=b(M,r,P,e);te({index:n,direction:e,...t})},[te,M,L,P]),ae=r.useCallback(e=>{e!==M&&ne({direction:e>M?1:-1,index:e})},[M,ne]);r.useEffect(()=>{const e=()=>{const e=$.current.getBoundingClientRect();z(e)};return window.addEventListener("resize",e),e(),()=>{window.removeEventListener("resize",e)}},[]),r.useEffect(()=>{let e;const r=()=>{e=requestAnimationFrame(r),O.current&&K.current.render(X.current,J.current)};return e=requestAnimationFrame(r),()=>{cancelAnimationFrame(e)}},[]),r.useEffect(()=>{if(C){const e=()=>{N(!1)},r=Z.current;return r.addEventListener("transitionend",e),()=>{r&&r.removeEventListener("transitionend",e)}}},[C]);const ie=r.useCallback(e=>{if(O.current||!W.current||!P)return;G.current=e;const r=Math.abs(e),t=q.width;V.current=e>0?-1:1;const n=1-(r-t)/t*-1,a=b(M,null,F,V.current),i=W.current.uniforms,o=Math.min(Math.max(n,0),1);i.currentImage.value=P[M],i.nextImage.value=P[a],i.direction.value=V.current,i.dispFactor.value=o,requestAnimationFrame(()=>{K.current.render(X.current,J.current)})},[q,M,F,P]),oe=r.useCallback(()=>{if(!W.current)return;const e=W.current.uniforms,r=1e3*(1-e.dispFactor.value),t=Math.abs(G.current),n=.2*q.width;G.current=0,O.current||0!==t&&t&&(t>n?ne({duration:r,direction:V.current}):(e.currentImage.value=e.nextImage.value,e.nextImage.value=e.currentImage.value,e.dispFactor.value=1-e.dispFactor.value,ne({direction:-1*V.current,index:M})))},[q,M,ne]),ce=r.useCallback(e=>{ie(e.clientX-ee.current)},[ie]),se=r.useCallback(()=>{k(!1),oe(),document.removeEventListener("pointerup",se),document.removeEventListener("pointermove",ce)},[ce,oe]),ue=r.useCallback(e=>{ee.current=e.clientX,k(!0),document.addEventListener("pointermove",ce),document.addEventListener("pointerup",se)},[ce,se]);return e.jsxs("div",{className:"_carousel_156nm_2",onKeyDown:e=>{switch(e.key){case"ArrowRight":ne({direction:1});break;case"ArrowLeft":ne({direction:-1})}},...R,children:[e.jsxs("div",{className:"_content_156nm_6",children:[e.jsxs("div",{className:"_imageWrapper_156nm_12","data-dragging":E,onPointerDown:ue,style:v({aspectRatio:`${w} / ${I}`}),children:[e.jsx("div",{"aria-atomic":!0,className:"_canvasWrapper_156nm_24","aria-live":"polite","aria-label":re,role:"img",children:e.jsx("canvas",{"aria-hidden":!0,className:"_canvas_156nm_24",ref:$})}),D&&C&&e.jsx("img",{"aria-hidden":!0,className:"_placeholder_156nm_37","data-loaded":L&&!!P,src:C,ref:Z,alt:"",role:"presentation"})]}),e.jsx("button",{className:_,"data-prev":!0,"aria-label":"Previous slide",onClick:()=>ne({direction:-1}),children:e.jsx(y,{})}),e.jsx("button",{className:_,"data-next":!0,"aria-label":"Next slide",onClick:()=>ne({direction:1}),children:e.jsx(j,{})})]}),e.jsx("div",{className:"_nav_156nm_108",children:F.map((r,t)=>e.jsx("button",{className:"_navButton_156nm_115",onClick:()=>ae(t),"aria-label":`Jump to slide ${t+1}`,"aria-pressed":t===M},r.alt))})]})};function y(){return e.jsx("svg",{fill:"currentColor",width:"18",height:"42",viewBox:"0 0 18 42",children:e.jsx("path",{d:"M18.03 1.375L16.47.125-.031 20.75l16.5 20.625 1.562-1.25L2.53 20.75z"})})}function j(){return e.jsx("svg",{fill:"currentColor",width:"18",height:"42",viewBox:"0 0 18 42",children:e.jsx("path",{d:"M-.03 1.375L1.53.125l16.5 20.625-16.5 20.625-1.562-1.25 15.5-19.375z"})})}export{w as Carousel};
